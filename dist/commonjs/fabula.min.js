// Fabula version 0.15.0 generated by Haxe
!function(b,L){"use strict";b.fabula=b.fabula||{};function t(){return m.__string_rec(this,"")}var s,q={};function e(e,t){var n,i=Object.create(e);for(n in t)i[n]=t[n];return t.toString!==Object.prototype.toString&&(i.toString=t.toString),i}function F(e,t){this.r=new RegExp(e,t.split("u").join(""))}function x(){}function r(){}function w(){}function y(){this.b=""}F.__name__="EReg",F.prototype={match:function(e){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(e),this.r.s=e,null!=this.r.m},matched:function(e){if(null!=this.r.m&&0<=e&&e<this.r.m.length)return this.r.m[e];throw A.thrown("EReg::matched")},replace:function(e,t){return e.replace(this.r,t)},__class__:F},x.__name__="HxOverrides",x.cca=function(e,t){e=e.charCodeAt(t);return e!=e?ie.get_undefined():e},x.substr=function(e,t,n){if(null==n)n=e.length;else if(n<0){if(0!=t)return"";n=e.length+n}return e.substr(t,n)},x.remove=function(e,t){t=e.indexOf(t);return-1!=t&&(e.splice(t,1),!0)},x.now=function(){return Date.now()},Math.__name__="Math",r.__name__="Reflect",r.field=function(e,t){try{return e[t]}catch(e){return null}},r.callMethod=function(e,t,n){return t.apply(e,n)},r.isFunction=function(e){return"function"==typeof e&&!(m.isClass(e)||m.isEnum(e))},w.__name__="Std",w.string=function(e){return m.__string_rec(e,"")},w.parseInt=function(e){if(null!=e)for(var t=0,n=e.length;t<n;){var i=t++,r=N.fastCodeAt(e,i);if(r<=8||14<=r&&32!=r&&45!=r)return r=N.fastCodeAt(e,1+i),i=parseInt(e,120==r||88==r?16:10),isNaN(i)?null:i}return null},w.parseFloat=function(e){return parseFloat(e)};function E(){}function C(e){this.nodeType=e,this.children=[],this.attributeMap=v.toStringMap(null)}function T(e,t,n,i,r,a,s){null==s&&(s=0),null==a&&(a=!1),this.id=e,this.text=""!=t&&null!=t?t:e,this.type=n,this.target=r,this.condition=i,this.isExit=a,this.limit=s,this.count=0,h.helperList.set(this.id,d.EVENT)}function B(e,t,n,i,r,a,s,o,u,l){null==a&&(a=0),null==r&&(r=1),null==i&&(i=!1),this.id=e,this.text=t,this.conditions=n,this.isExit=i,this.limit=a,this.count=0,this.speaker=s,this.listeners=o,this.environment=u,this.target=l,h.helperList.set(this.id,d.EVENT)}function a(e,t,n){null==n&&(n=!0),this.condition=e,this.type=t,this._affirmation=n}function l(){this.condition=[],a.call(this,this.condition,null)}function o(e,t,n){null==n&&(n=!0),this._isCompleted=t,a.call(this,e,d.EVENT,n)}function n(e,t,n){this.id=e,this.type=t,this.set(n),this.startingValue=this.value,h.helperList.set(this.id,d.VARIABLE)}function S(e,t,n){this.xml=t,this.message=e,this.position=n,this.lineNumber=1;for(var i=this.positionAtLine=0,r=n;i<r;){var a=i++,a=N.fastCodeAt(t,a);10==a?(this.lineNumber++,this.positionAtLine=0):13!=a&&this.positionAtLine++}}y.__name__="StringBuf",y.prototype={add:function(e){this.b+=w.string(e)},addChar:function(e){this.b+=String.fromCodePoint(e)},addSub:function(e,t,n){this.b+=x.substr(e,t,null==n?null:n)},toString:function(){return this.b},__class__:y};var N=function(){},i=(N.__name__="StringTools",N.htmlEscape=function(e,t){for(var n=new y,i=new J(e);i.hasNext();){var r=i.next();switch(r){case 34:t?n.add("&quot;"):n.addChar(r);break;case 38:n.add("&amp;");break;case 39:t?n.add("&#039;"):n.addChar(r);break;case 60:n.add("&lt;");break;case 62:n.add("&gt;");break;default:n.addChar(r)}}return n.toString()},N.isSpace=function(e,t){e=x.cca(e,t);return 8<e&&e<14||32==e},N.ltrim=function(e){for(var t=e.length,n=0;n<t&&N.isSpace(e,n);)++n;return 0<n?x.substr(e,n,t-n):e},N.rtrim=function(e){for(var t=e.length,n=0;n<t&&N.isSpace(e,t-n-1);)++n;return 0<n?x.substr(e,0,t-n):e},N.trim=function(e){return N.ltrim(N.rtrim(e))},N.fastCodeAt=function(e,t){return e.charCodeAt(t)},N.unsafeCodeAt=function(e,t){return e.charCodeAt(t)},N.utf16CodePointAt=function(e,t){var n=N.fastCodeAt(e,t);return n=55296<=n&&n<=56319?n-55232<<10|1023&N.fastCodeAt(e,t+1):n},E.__name__="Type",E.getClass=function(e){return m.getClass(e)},E.getClassName=function(e){return e.__name__},E.createEnum=function(e,t,n){var i=r.field(e,t);if(null==i)throw A.thrown("No such constructor "+t);if(r.isFunction(i)){if(null==n)throw A.thrown("Constructor "+t+" need parameters");return r.callMethod(e,i,n)}if(null!=n&&0!=n.length)throw A.thrown("Constructor "+t+" does not need parameters");return i},{}),u=(i.toString=function(e){switch(e){case 0:return"Element";case 1:return"PCData";case 2:return"CData";case 3:return"Comment";case 4:return"DocType";case 5:return"ProcessingInstruction";case 6:return"Document"}},C.__name__="Xml",C.parse=function(e){return U.parse(e)},C.createElement=function(e){var t=new C(C.Element);return t.set_nodeName(e),t},C.createPCData=function(e){var t=new C(C.PCData);return t.set_nodeValue(e),t},C.createCData=function(e){var t=new C(C.CData);return t.set_nodeValue(e),t},C.createComment=function(e){var t=new C(C.Comment);return t.set_nodeValue(e),t},C.createDocType=function(e){var t=new C(C.DocType);return t.set_nodeValue(e),t},C.createProcessingInstruction=function(e){var t=new C(C.ProcessingInstruction);return t.set_nodeValue(e),t},C.createDocument=function(){return new C(C.Document)},C.prototype={get_nodeName:function(){if(this.nodeType!=C.Element)throw A.thrown("Bad node type, expected Element but found "+(null==this.nodeType?"null":i.toString(this.nodeType)));return this.nodeName},set_nodeName:function(e){if(this.nodeType!=C.Element)throw A.thrown("Bad node type, expected Element but found "+(null==this.nodeType?"null":i.toString(this.nodeType)));return this.nodeName=e},get_nodeValue:function(){if(this.nodeType==C.Document||this.nodeType==C.Element)throw A.thrown("Bad node type, unexpected "+(null==this.nodeType?"null":i.toString(this.nodeType)));return this.nodeValue},set_nodeValue:function(e){if(this.nodeType==C.Document||this.nodeType==C.Element)throw A.thrown("Bad node type, unexpected "+(null==this.nodeType?"null":i.toString(this.nodeType)));return this.nodeValue=e},get:function(e){if(this.nodeType!=C.Element)throw A.thrown("Bad node type, expected Element but found "+(null==this.nodeType?"null":i.toString(this.nodeType)));return v.get(this.attributeMap,e)},set:function(e,t){if(this.nodeType!=C.Element)throw A.thrown("Bad node type, expected Element but found "+(null==this.nodeType?"null":i.toString(this.nodeType)));v.set(this.attributeMap,e,t)},exists:function(e){if(this.nodeType!=C.Element)throw A.thrown("Bad node type, expected Element but found "+(null==this.nodeType?"null":i.toString(this.nodeType)));return v.exists(this.attributeMap,e)},attributes:function(){if(this.nodeType!=C.Element)throw A.thrown("Bad node type, expected Element but found "+(null==this.nodeType?"null":i.toString(this.nodeType)));return v.keys(this.attributeMap)},iterator:function(){return this.ensureElementType(),new Z(this.children)},elements:function(){this.ensureElementType();for(var e=[],t=0,n=this.children;t<n.length;){var i=n[t];++t,i.nodeType==C.Element&&e.push(i)}return new Z(e)},elementsNamed:function(e){this.ensureElementType();for(var t=[],n=0,i=this.children;n<i.length;){var r=i[n];++n,r.nodeType==C.Element&&r.get_nodeName()==e&&t.push(r)}return new Z(t)},firstElement:function(){this.ensureElementType();for(var e=0,t=this.children;e<t.length;){var n=t[e];if(++e,n.nodeType==C.Element)return n}return null},addChild:function(e){this.ensureElementType(),null!=e.parent&&e.parent.removeChild(e),this.children.push(e),e.parent=this},removeChild:function(e){return this.ensureElementType(),!!x.remove(this.children,e)&&!(e.parent=null)},toString:function(){return ne.print(this)},ensureElementType:function(){if(this.nodeType!=C.Document&&this.nodeType!=C.Element)throw A.thrown("Bad node type, expected Element or Document but found "+(null==this.nodeType?"null":i.toString(this.nodeType)))},__class__:C},T.__name__="fabula.Choice",T.prototype={addVariable:function(e,t){null==this.variables&&(this.variables=new c),this.variables.set(e,t)},__class__:T},B.__name__="fabula.Event",B.prototype={getChoices:function(){if(this._cacheChoices=[],null!=this.choices)for(var e=0,t=this.choices.length;e<t;){var n=e++;0<this.choices[n].limit&&this.choices[n].count>=this.choices[n].limit||null!=this.choices[n].condition&&!this.choices[n].condition.test()||this._cacheChoices.push(this.choices[n])}return 0==this._cacheChoices.length&&(this.isExit?this._cacheChoices.push(new T("EXIT",p.QUIT,"quit",null,this.target,!0)):this._cacheChoices.push(new T("CONTINUE",p.CONTINUE,"continue",null,this.target))),this._cacheChoices},selectChoice:function(e,t,n){var i=(n=null==n?!1:n)?this.choices:this._cacheChoices,r=null;if(null!=i)if(null!=e)for(var a=0,s=i.length;a<s;){var o=a++;if(i[o].id==e){r=i[o];break}}else null!=t&&(r=i[t]);return null!=r&&r.count++,r},testConditions:function(){var e=0<this.limit&&this.count>=this.limit;return null==this.conditions?!e:!e&&this.conditions.test()},addChoice:function(e){null==this.choices&&(this.choices=[],this._cacheChoices=[]),this.choices.push(e)},__class__:B},q["fabula.EEventType"]={__ename__:!0,__constructs__:null,QUEST:{_hx_name:"QUEST",_hx_index:0,__enum__:"fabula.EEventType",toString:t},RANDOM_ENCOUNTER:{_hx_name:"RANDOM_ENCOUNTER",_hx_index:1,__enum__:"fabula.EEventType",toString:t},SCENE:{_hx_name:"SCENE",_hx_index:2,__enum__:"fabula.EEventType",toString:t}}),u=(u.__constructs__=[u.QUEST,u.RANDOM_ENCOUNTER,u.SCENE],q["fabula.EPlayingType"]={__ename__:!0,__constructs__:null,SEQUENCE:{_hx_name:"SEQUENCE",_hx_index:0,__enum__:"fabula.EPlayingType",toString:t},DRAW:{_hx_name:"DRAW",_hx_index:1,__enum__:"fabula.EPlayingType",toString:t}}),p=(u.__constructs__=[u.SEQUENCE,u.DRAW],b.fabula.Fabula=function(e,t){this._questsID=[],this._encountersID=[],this._textsID=[],this.completedID=[],this._completedCallback=t,this.conditionFactory=new h(this),this._sequences=[];for(var n=0;n<e.length;){var i=e[n];++n,this.init(i)}}),I=(p.__name__="fabula.Fabula",p.prototype={init:function(e){e=I.parse(e,this);this.arrayMerge(this._sequences,e.sequences)},arrayMerge:function(e,t){for(var n=0,i=t.length;n<i;){var r=n++;e.push(t[r])}},mapMerge:function(e,t){for(var n,i=((n=v)instanceof Array?function(){return x.keyValueIter(n)}:"function"==typeof n.keyValueIterator?re(n,n.keyValueIterator):n.keyValueIterator)(t);i.hasNext();){var r=i.next(),a=r.key,r=r.value;v.arrayWrite(e,a,r)}},reset:function(){this.completedID.splice(0,this.completedID.length);for(var e=0,t=this._sequences;e<t.length;){var n=t[e];if(++e,null!=n.variables)for(var i=0,r=n.variables.length;i<r;){var a=i++;f.getByIndex(n.variables,a).reset()}n.completedID.splice(0,n.completedID.length);for(var s=0,o=n.events;s<o.length;){var u=o[s];if(++s,u.count=0,null!=u.choices)for(var l=0,c=u.choices;l<c.length;){var h=c[l];++l,h.count=0}}}},selectSequence:function(e,t){null==t&&(t=!0);for(var n=0,i=this._sequences.length;n<i;){var r=n++;if(this._sequences[r].id==e){r=this._sequences[r];if(t){if(null!=r.conditions&&!r.conditions.test())return null;this.currentSequence=r,this.currentSequence.start()}return r}}return null},getNextEvent:function(){var e=this.currentSequence.getNextEvent();return null!=e&&(e.count++,this.completedID.push(e.id),this.currentSequence.completedID.push(e.id),null!=this._completedCallback)&&this._completedCallback(e.id),e},getCurrentEvent:function(){return this.currentSequence.getEvent()},selectChoice:function(e,t){var n=null;if(null!=this.currentSequence&&this.currentSequence.current<this.currentSequence.events.length){if(null!=(n=this.currentSequence.getEvent().selectChoice(e,t)).variables)for(var i=n.variables.keys();i.hasNext();){var r=i.next(),a=this.getVar(r);null!=a&&a.set(n.variables.get(r))}this.currentSequence.nextTarget=n.isExit?"$$EXIT$$":n.target}return null!=n&&(this.completedID.push(e),this.currentSequence.completedID.push(e),null!=this._completedCallback)&&this._completedCallback(e),n},addVariable:function(e,t,n){switch(null==this.variables&&(this.variables=f._new()),t._hx_index){case 0:this.variables.push(new Y(e,n));break;case 1:this.variables.push(new X(e,n));break;case 2:this.variables.push(new $(e,n));break;case 3:this.variables.push(new H(e,n));break;case 4:this.variables.push(new g(e,n));break;case 5:this.variables.push(new Q(e,n))}},getVar:function(e){var t=null;return null!=this.currentSequence&&null!=this.currentSequence.variables&&null!=(t=f.get(this.currentSequence.variables,e))||null==t&&null!=this.variables&&(t=f.get(this.variables,e)),t},isIDCompleted:function(e){return"."==e.charAt(0)?-1!=this.currentSequence.completedID.indexOf(e.substring(1)):-1!=this.completedID.indexOf(e)},countWords:function(){for(var e=0,t=0,n=this._sequences;t<n.length;){var i=n[t];if(++t,null!=i.events)for(var r=0,a=i.events;r<a.length;){var s=a[r];if(++r,e+=s.text.split(" ").length,null!=s.choices)for(var o=0,u=s.choices;o<u.length;){var l=u[o];++o,e+=l.text.split(" ").length}}}return e},__class__:p},function(){}),M=(I.__name__="fabula.FabulaXmlParser",I.parse=function(e,t){I._conditionFactory=t.conditionFactory,I._xml=R._new(C.parse(e).firstElement());for(var n=0,i=O.resolve(R.get_nodes(I._xml),"variable");n<i.length;){var r=i[n];++n,t.addVariable(V.resolve(R.get_att(r),"id"),E.createEnum(k,V.resolve(R.get_att(r),"type").toUpperCase()),V.resolve(R.get_att(r),"value"))}for(var a=[],n=0,i=O.resolve(R.get_nodes(I._xml),"sequence");n<i.length;){var s=i[n];if(++n,te.resolve(R.get_has(s),"id")){var o=V.resolve(R.get_att(s),"id"),u=(I.ID_GEN_HELPER=o,I.ID_GEN_COUNT=0,[]),l=[],o=new M(o),s=(o.addConditions(I._conditionFactory.create(P.getString(s,"if"))),I.parseEvents(s,o,u,l));if(null!=s)if(console.log("fabula/FabulaXmlParser.hx:54:",s.id),null!=s.choices)for(var c=0,h=s.choices;c<h.length;){var _=h[c];++c,null==_.target&&(_.isExit=!0)}else s.isExit=!0;o.addSequence(u,l),a.push(o)}else console.log("fabula/FabulaXmlParser.hx:37:","id attribute is mandatory in the sequence tag")}if(D.resolve(R.get_hasNode(I._xml),"words"))for(var d=R.get_elements(O.resolve(R.get_nodes(I._xml),"words")[0]);d.hasNext();){var f=d.next();switch(R.get_name(f).toUpperCase()){case"CONTINUE":p.CONTINUE=R.get_innerData(f);break;case"QUIT":p.QUIT=R.get_innerData(f)}}for(n=0,i=O.resolve(R.get_nodes(I._xml),"list");n<i.length;){i[n];++n,console.log("fabula/FabulaXmlParser.hx:91:","coucou list")}return{sequences:a}},I.parseEvents=function(e,t,n,i,r){var a=null,s=R.get_elements(e);e:for(;s.hasNext();){var o=s.next();switch(R.get_name(o)){case"choice":if(null==a){console.log("fabula/FabulaXmlParser.hx:163:","impossible to add a choice without a parent event");break e}var u=new T(P.getString(o,"id",I.ID_GEN_HELPER+"_C"+ ++I.ID_GEN_COUNT),I.getText(o),P.getString(o,"type"),I._conditionFactory.create(P.getString(o,"if")),P.getString(o,"target"),P.getBool(o,"exit",a.isExit),P.getInt(o,"limit"));if(D.resolve(R.get_hasNode(o),"variable"))for(var l=0,c=O.resolve(R.get_nodes(o),"variable");l<c.length;){var h=c[l];++l,u.addVariable(V.resolve(R.get_att(h),"id"),V.resolve(R.get_att(h),"value"))}a.addChoice(u);break;case"event":var _,d=P.getString(o,"id",I.ID_GEN_HELPER+"_E"+ ++I.ID_GEN_COUNT);if(null==r?_=P.getString(o,"if"):(_=r.id,r.target=d),a=new B(d,I.getText(o),I._conditionFactory.create(_),P.getBool(o,"exit",!1),P.getInt(o,"weight",1),P.getInt(o,"limit"),P.getString(o,"speaker"),P.getString(o,"listeners"),P.getString(o,"environment"),P.getString(o,"target")),D.resolve(R.get_hasNode(o),"choice"))for(var f=0,p=O.resolve(R.get_nodes(o),"choice");f<p.length;){var g=p[f],v=(++f,new T(P.getString(g,"id",I.ID_GEN_HELPER+"_C"+ ++I.ID_GEN_COUNT),I.getText(g),P.getString(g,"type"),I._conditionFactory.create(P.getString(g,"if")),P.getString(g,"target"),P.getBool(g,"exit",a.isExit),P.getInt(g,"limit")));if(D.resolve(R.get_hasNode(g),"variable"))for(var m=0,b=O.resolve(R.get_nodes(g),"variable");m<b.length;){var x=b[m];++m,v.addVariable(V.resolve(R.get_att(x),"id"),V.resolve(R.get_att(x),"value"))}a.addChoice(v),D.resolve(R.get_hasNode(g),"event")&&I.parseEvents(g,t,n,i,v)}(null==r?n:i).push(a);break;case"variable":"sequence"==R.get_name(e)&&t.addVariable(V.resolve(R.get_att(o),"id"),E.createEnum(k,V.resolve(R.get_att(o),"type").toUpperCase()),V.resolve(R.get_att(o),"value"))}}return a},I.getText=function(e){var t=P.getString(e,"text");return t=""==t&&D.resolve(R.get_hasNode(e),"text")?R.get_innerData(ee.resolve(R.get_node(e),"text")):t},function(e){this.id=e,this.current=-1,this.currentId=null,this.numCompleted=0,this.nextTarget=null,this.completedID=[]}),c=(M.__name__="fabula.Sequence",M.prototype={addConditions:function(e){this.conditions=e},addVariable:function(e,t,n){switch(null==this.variables&&(this.variables=f._new()),t._hx_index){case 0:this.variables.push(new Y(e,n));break;case 1:this.variables.push(new X(e,n));break;case 2:this.variables.push(new $(e,n));break;case 3:this.variables.push(new H(e,n));break;case 4:this.variables.push(new g(e,n));break;case 5:this.variables.push(new Q(e,n))}},addSequence:function(e,t){null==this.events&&null==this.branches||console.log("fabula/Sequence.hx:74:","WARNING a new sequence will replace an old sequence"),this.events=e,this.branches=t},start:function(){if(this.current=-1,this.nextTarget=null,(this.currentId=null)!=this.variables)for(var e=0,t=this.variables.length;e<t;){var n=e++;f.getByIndex(this.variables,n).reset()}this.completedID.splice(0,this.completedID.length)},getNextEvent:function(e){if(!(e=null==e?!1:e)&&-1<this.current&&this.current<this.events.length&&(this.events[this.current].isExit||"$$EXIT$$"==this.nextTarget))this.numCompleted++,console.log("fabula/Sequence.hx:108:","[Fabula] sequence "+this.id+" completed");else if(this.current+1<=this.events.length){if(0<=this.current){if(null!=this.nextTarget&&""!=this.nextTarget)return e=this.nextTarget,this.nextTarget=null,this.getEvent(e);if(null!=this.events[this.current].target&&""!=this.events[this.current].target)return this.getEvent(this.events[this.current].target)}if(this.current++,this.current<this.events.length)return(e=this.events[this.current]).testConditions()?(this.currentId=e.id,e):this.getNextEvent(!0);this.numCompleted++,console.log("fabula/Sequence.hx:142:","sequence completed")}return null},getEvent:function(e){null==e&&(e=this.currentId);for(var t=0,n=this.events.length;t<n;){var i=t++;if(this.events[i].id==e)return this.current=i,this.currentId=e,this.events[i]}for(t=0,n=this.branches.length;t<n;){i=t++;if(this.branches[i].id==e)return this.currentId=e,this.branches[i]}return null},__class__:M},a.__name__="fabula.condition.Condition",a.prototype={test:function(){throw A.thrown("[Condition] Override test function")},__class__:a},l.__name__="fabula.condition.ConditionCollection",l.__super__=a,l.prototype=e(a.prototype,{add:function(e){this.condition.push(e)},test:function(){for(var e=0,t=this.condition;e<t.length;){var n=t[e];if(++e,!n.test())return!1}return!0},hasType:function(e){for(var t=0,n=this.condition;t<n.length;){var i=n[t];if(++t,i.type==e)return!0}return!1},hasOnlyTypes:function(e){for(var t=0,n=this.condition;t<n.length;){var i=n[t];if(++t,null==i.type){if(!i.hasOnlyTypes(e))return!1}else if(-1==e.indexOf(i.type))return!1}return!0},__class__:l}),o.__name__="fabula.condition.ConditionEvent",o.__super__=a,o.prototype=e(a.prototype,{test:function(){return this._isCompleted(this.condition)?this._affirmation:!this._affirmation},__class__:o}),function(){this.h=Object.create(null)}),h=(c.__name__="haxe.ds.StringMap",c.prototype={exists:function(e){return Object.prototype.hasOwnProperty.call(this.h,e)},get:function(e){return this.h[e]},set:function(e,t){this.h[e]=t},keys:function(){return new K(this.h)},keyValueIterator:function(){return new z(this.h)},__class__:c},function(e){this.fabula=e}),j=(h.__name__="fabula.condition.ConditionFactory",h.prototype={create:function(e){if(""==e)return null;for(var t=new l,n=-1!=e.indexOf(",")?e.split(","):e.split("&"),i=0;i<n.length;){var r=n[i];if(++i,-1!=r.indexOf("|")){for(var a=new j,s=r.split("|"),o=0;o<s.length;){var u=s[o];++o,this.addToCollection(a,u)}t.add(a)}else this.addToCollection(t,r)}return t},addToCollection:function(e,t){var n=0==t.indexOf("!");n&&(t=x.substr(t,1,null));var i=null,r=null;if(h.regexp.match(t)&&(t=h.regexp.matched(1),r=h.regexp.matched(2),i=h.regexp.matched(3)),""==i||null==i?(r="=",i=!0):"(in:"==r&&(r="in",a=t,t=i,i=a),h.helperList.exists(t)){var a=h.helperList.get(t);if(null==a)throw A.thrown("[Fabula > Condition] To use other condition type, please override ConditionFactory class and create a Condition class for this type");switch(a._hx_index){case 0:e.add(new o(t,re(s=this.fabula,s.isIDCompleted),!n));break;case 1:e.add(new G(t,_.fromString(r),i,re(s=this.fabula,s.getVar),!n));break;default:throw A.thrown("[Fabula > Condition] To use other condition type, please override ConditionFactory class and create a Condition class for this type")}}else e.add(new o(t,re(s=this.fabula,s.isIDCompleted),!n))},__class__:h},function(){l.call(this)}),G=(j.__name__="fabula.condition.ConditionOr",j.__super__=l,j.prototype=e(l.prototype,{test:function(){for(var e=0,t=this.condition;e<t.length;){var n=t[e];if(++e,n.test())return!0}return!1},__class__:j}),function(e,t,n,i,r){a.call(this,e,d.VARIABLE,r=null==r?!0:r),this._getVar=i,this._operation=t,this._targetValue=n}),_=(G.__name__="fabula.condition.ConditionVariable",G.__super__=a,G.prototype=e(a.prototype,{test:function(){return this._getVar(this.condition).compare(this._operation,this._targetValue)==this._affirmation},__class__:G}),{}),d=(_.fromString=function(e){switch(e){case"!=":return"!=";case"<":return"<";case"<=":return"<=";case"=":return"=";case">":return">";case">=":return">=";case"in":return"in";default:return null}},q["fabula.condition.EConditionType"]={__ename__:!0,__constructs__:null,EVENT:{_hx_name:"EVENT",_hx_index:0,__enum__:"fabula.condition.EConditionType",toString:t},VARIABLE:{_hx_name:"VARIABLE",_hx_index:1,__enum__:"fabula.condition.EConditionType",toString:t},INVENTORY:{_hx_name:"INVENTORY",_hx_index:2,__enum__:"fabula.condition.EConditionType",toString:t},HAS_CHARACTER:{_hx_name:"HAS_CHARACTER",_hx_index:3,__enum__:"fabula.condition.EConditionType",toString:t},IS_CHARACTER:{_hx_name:"IS_CHARACTER",_hx_index:4,__enum__:"fabula.condition.EConditionType",toString:t},TRAIT:{_hx_name:"TRAIT",_hx_index:5,__enum__:"fabula.condition.EConditionType",toString:t},ATTRIBUTS:{_hx_name:"ATTRIBUTS",_hx_index:6,__enum__:"fabula.condition.EConditionType",toString:t},SKILLS:{_hx_name:"SKILLS",_hx_index:7,__enum__:"fabula.condition.EConditionType",toString:t},CUSTOM:((s=function(e){return{_hx_index:8,type:e,__enum__:"fabula.condition.EConditionType",toString:t}})._hx_name="CUSTOM",s.__params__=["type"],s)}),k=(d.__constructs__=[d.EVENT,d.VARIABLE,d.INVENTORY,d.HAS_CHARACTER,d.IS_CHARACTER,d.TRAIT,d.ATTRIBUTS,d.SKILLS,d.CUSTOM],q["fabula.condition.EVariableType"]={__ename__:!0,__constructs__:null,STRING:{_hx_name:"STRING",_hx_index:0,__enum__:"fabula.condition.EVariableType",toString:t},INT:{_hx_name:"INT",_hx_index:1,__enum__:"fabula.condition.EVariableType",toString:t},FLOAT:{_hx_name:"FLOAT",_hx_index:2,__enum__:"fabula.condition.EVariableType",toString:t},BOOL:{_hx_name:"BOOL",_hx_index:3,__enum__:"fabula.condition.EVariableType",toString:t},ENUM:{_hx_name:"ENUM",_hx_index:4,__enum__:"fabula.condition.EVariableType",toString:t},CYCLE:{_hx_name:"CYCLE",_hx_index:5,__enum__:"fabula.condition.EVariableType",toString:t}}),H=(k.__constructs__=[k.STRING,k.INT,k.FLOAT,k.BOOL,k.ENUM,k.CYCLE],n.__name__="fabula.condition.Variable",n.prototype={set:function(e){throw A.thrown("[Fabula > variable] This method needs to be overriden")},convert:function(e){throw A.thrown("[Fabula > variable] This method needs to be overriden")},compare:function(e,t){switch(e){case"!=":return this.value!=t;case"=":return this.value==t;default:return!1}},reset:function(){this.value=this.startingValue},toString:function(){return"[var "+this.id+" : v:"+w.string(this.value)+", d:"+w.string(this.startingValue)+"]"},__class__:n},function(e,t){n.call(this,e,k.BOOL,t)}),f=(H.__name__="fabula.condition.VariableBool",H.__super__=n,H.prototype=e(n.prototype,{set:function(e){var t=this.value;return this.value="true"==e||"1"==e,t!=this.value},convert:function(e){return"true"==e||"1"==e},__class__:H}),{}),g=(f._new=function(){return[]},f.getByIndex=function(e,t){return e[t]},f.get=function(e,t){for(var n=0;n<e.length;){var i=e[n];if(++n,i.id==t)return i}return null},function(e,t){this.options=t.split(","),n.call(this,e,k.ENUM,t)}),Q=(g.__name__="fabula.condition.VariableEnum",g.__super__=n,g.prototype=e(n.prototype,{set:function(e){var t,n=this.value,i=w.parseInt(e);if(null==i){if("+"==(e=e==this.options.toString()?this.options[0]:e)){if(!((t=this.options.indexOf(this.value)+1)<this.options.length))return!1;e=this.options[t]}else if("-"==e){if(!(0<=(t=this.options.indexOf(this.value)-1)))return!1;e=this.options[t]}else if(-1==this.options.indexOf(e))return console.log("fabula/condition/VariableEnum.hx:51:","[Fabula > Variable] "+e+" not in options of "+this.id),!1;this.value=e}else{if(i>=this.options.length||i<0)return console.log("fabula/condition/VariableEnum.hx:60:","[Fabula > Variable] "+i+" not in length of "+this.id),!1;this.value=this.options[i]}return n!=this.value},convert:function(e){return e},__class__:g}),function(e,t){g.call(this,e,t),this.type=k.CYCLE}),$=(Q.__name__="fabula.condition.VariableCycle",Q.__super__=g,Q.prototype=e(g.prototype,{set:function(e){var t,n=this.value,i=w.parseInt(e);if(null==i){if("+"==(e=e==this.options.toString()?this.options[0]:e))(t=this.options.indexOf(this.value)+1)>=this.options.length&&(t=0),e=this.options[t];else if("-"==e)(t=this.options.indexOf(this.value)-1)<0&&(t=this.options.length-1),e=this.options[t];else if(-1==this.options.indexOf(e))return console.log("fabula/condition/VariableCycle.hx:45:","[Fabula > Variable] "+e+" not in options of "+this.id),!1;this.value=e}else i>=this.options.length?i=this.options.length-1:i<0&&(i=0),this.value=this.options[i];return n!=this.value},__class__:Q}),function(e,t){n.call(this,e,k.FLOAT,t)}),X=($.__name__="fabula.condition.VariableFloat",$.__super__=n,$.prototype=e(n.prototype,{set:function(e){var t=this.value;switch(e){case"+":case"++":this.value++;break;case"-":case"--":this.value--;break;default:var n=this.extract(e);switch(n.operation){case"+":this.value+=n.subValue;break;case"-":this.value-=n.subValue;break;default:this.value=n.subValue}}return t!=this.value},extract:function(e){var t=e.charAt(0);return{operation:t,subValue:w.parseFloat("+"==t||"-"==t?e.substring(1):e)}},convert:function(e){return w.parseFloat(e)},compare:function(e,t){switch(e){case"!=":return this.value!=t;case"<":return this.value<t;case"<=":return this.value<=t;case"=":return this.value==t;case">":return this.value>t;case">=":return this.value>=t;default:return!1}},__class__:$}),function(e,t){n.call(this,e,k.INT,t)}),Y=(X.__name__="fabula.condition.VariableInt",X.__super__=n,X.prototype=e(n.prototype,{set:function(e){var t=this.value;switch(e){case"+":case"++":this.value++;break;case"-":case"--":this.value--;break;default:var n=this.extract(e);switch(n.operation){case"+":this.value+=n.subValue;break;case"-":this.value-=n.subValue;break;default:this.value=n.subValue}}return t!=this.value},extract:function(e){var t=e.charAt(0);return{operation:t,subValue:w.parseInt("+"==t||"-"==t?e.substring(1):e)}},convert:function(e){return w.parseInt(e)},compare:function(e,t){switch(e){case"!=":return this.value!=t;case"<":return this.value<t;case"<=":return this.value<=t;case"=":return this.value==t;case">":return this.value>t;case">=":return this.value>=t;default:return!1}},__class__:X}),function(e,t){n.call(this,e,k.STRING,t)}),A=(Y.__name__="fabula.condition.VariableString",Y.__super__=n,Y.prototype=e(n.prototype,{set:function(e){var t=this.value;return this.value=e,t!=this.value},convert:function(e){return e},compare:function(e,t){switch(e){case"!=":return this.value!=t;case"=":return this.value==t;case"in":return-1!=this.value.indexOf(t);default:return!1}},__class__:Y}),function(e,t,n){Error.call(this,e),this.message=e,this.__previousException=t,this.__nativeException=null!=n?n:this}),W=(A.__name__="haxe.Exception",A.thrown=function(e){return e instanceof A?e.get_native():e instanceof Error?e:new W(e)},A.__super__=Error,A.prototype=e(Error.prototype,{__shiftStack:function(){this.__skipStack++},get_native:function(){return this.__nativeException},__class__:A}),function(e,t,n){A.call(this,String(e),t,n),this.value=e,this.__shiftStack()}),v=(W.__name__="haxe.ValueException",W.__super__=A,W.prototype=e(A.prototype,{__class__:W}),{}),K=(v.set=function(e,t,n){e.set(t,n)},v.get=function(e,t){return e.get(t)},v.exists=function(e,t){return e.exists(t)},v.keys=function(e){return e.keys()},v.keyValueIterator=function(e){return e.keyValueIterator()},v.arrayWrite=function(e,t,n){return e.set(t,n),n},v.toStringMap=function(e){return new c},function(e){this.h=e,this.keys=Object.keys(e),this.length=this.keys.length,this.current=0}),z=(K.__name__="haxe.ds._StringMap.StringMapKeyIterator",K.prototype={hasNext:function(){return this.current<this.length},next:function(){return this.keys[this.current++]},__class__:K},function(e){this.h=e,this.keys=Object.keys(e),this.length=this.keys.length,this.current=0}),Z=(z.__name__="haxe.ds._StringMap.StringMapKeyValueIterator",z.prototype={hasNext:function(){return this.current<this.length},next:function(){var e=this.keys[this.current++];return{key:e,value:this.h[e]}},__class__:z},function(e){this.current=0,this.array=e}),J=(Z.__name__="haxe.iterators.ArrayIterator",Z.prototype={hasNext:function(){return this.current<this.array.length},next:function(){return this.array[this.current++]},__class__:Z},function(e){this.offset=0,this.s=e}),ee=(J.__name__="haxe.iterators.StringIteratorUnicode",J.prototype={hasNext:function(){return this.offset<this.s.length},next:function(){var e=N.utf16CodePointAt(this.s,this.offset++);return 65536<=e&&this.offset++,e},__class__:J},{}),V=(ee.resolve=function(e,t){var n=e.elementsNamed(t).next();if(null==n)throw e=e.nodeType==C.Document?"Document":e.get_nodeName(),A.thrown(e+" is missing element "+t);return R._new(n)},{}),te=(V.resolve=function(e,t){if(e.nodeType==C.Document)throw A.thrown("Cannot access document attribute "+t);var n=e.get(t);if(null==n)throw A.thrown(e.get_nodeName()+" is missing attribute "+t);return n},{}),D=(te.resolve=function(e,t){if(e.nodeType==C.Document)throw A.thrown("Cannot access document attribute "+t);return e.exists(t)},{}),O=(D.resolve=function(e,t){return e.elementsNamed(t).hasNext()},{}),R=(O.resolve=function(e,t){for(var n=[],i=e.elementsNamed(t);i.hasNext();){var r=i.next();n.push(R._new(r))}return n},{}),U=(R.get_x=function(e){return e},R.get_name=function(e){return e.nodeType==C.Document?"Document":e.get_nodeName()},R.get_node=function(e){return R.get_x(e)},R.get_nodes=function(e){return e},R.get_att=function(e){return e},R.get_has=function(e){return e},R.get_hasNode=function(e){return R.get_x(e)},R.get_elements=function(e){return e.elements()},R._new=function(e){if(e.nodeType!=C.Document&&e.nodeType!=C.Element)throw A.thrown("Invalid nodeType "+(null==e.nodeType?"null":i.toString(e.nodeType)));return e},R.get_innerData=function(e){var t=e.iterator();if(!t.hasNext())throw A.thrown(R.get_name(e)+" does not have data");var n=t.next();if(t.hasNext()){var i=t.next();if(n.nodeType==C.PCData&&i.nodeType==C.CData&&""==N.trim(n.get_nodeValue())){if(!t.hasNext())return i.get_nodeValue();var r=t.next();if(r.nodeType==C.PCData&&""==N.trim(r.get_nodeValue())&&!t.hasNext())return i.get_nodeValue()}throw A.thrown(R.get_name(e)+" does not only have data")}if(n.nodeType!=C.PCData&&n.nodeType!=C.CData)throw A.thrown(R.get_name(e)+" does not have data");return n.get_nodeValue()},S.__name__="haxe.xml.XmlParserException",S.prototype={toString:function(){return E.getClassName(E.getClass(this))+": "+this.message+" at line "+this.lineNumber+" char "+this.positionAtLine},__class__:S},function(){}),ne=(U.__name__="haxe.xml.Parser",U.parse=function(e,t){null==t&&(t=!1);var n=C.createDocument();return U.doParse(e,t,0,n),n},U.doParse=function(e,t,n,i){null==n&&(n=0);for(var r=null,a=1,s=1,o=null,u=0,l=0,c=0,h=new y,_=1,d=-1;n<e.length;){var f,p,g=N.unsafeCodeAt(e,n);switch(a){case 0:switch(g){case 9:case 10:case 13:case 32:break;default:a=s;continue}break;case 1:if(60!=g){u=n,a=13;continue}a=0,s=2;break;case 2:switch(g){case 33:if(91==N.fastCodeAt(e,n+1)){if("CDATA["!=x.substr(e,n+=2,6).toUpperCase())throw A.thrown(new S("Expected <![CDATA[",e,n));a=17,u=(n+=5)+1}else if(68==N.fastCodeAt(e,n+1)||100==N.fastCodeAt(e,n+1)){if("OCTYPE"!=x.substr(e,n+2,6).toUpperCase())throw A.thrown(new S("Expected <!DOCTYPE",e,n));a=16,u=(n+=8)+1}else{if(45!=N.fastCodeAt(e,n+1)||45!=N.fastCodeAt(e,n+2))throw A.thrown(new S("Expected \x3c!--",e,n));a=15,u=(n+=2)+1}break;case 47:if(null==i)throw A.thrown(new S("Expected node name",e,n));u=n+1,a=0,s=10;break;case 63:a=14,u=n;break;default:a=3,u=n;continue}break;case 3:if(U.isValidChar(g))break;if(n==u)throw A.thrown(new S("Expected node name",e,n));r=C.createElement(x.substr(e,u,n-u)),i.addChild(r),++l,a=0,s=4;continue;case 4:switch(g){case 47:a=11;break;case 62:a=9;break;default:a=5,u=n;continue}break;case 5:if(U.isValidChar(g))break;if(u==n)throw A.thrown(new S("Expected attribute name",e,n));o=x.substr(e,u,n-u);if(r.exists(o))throw A.thrown(new S("Duplicate attribute ["+o+"]",e,n));a=0,s=6;continue;case 6:if(61!=g)throw A.thrown(new S("Expected =",e,n));a=0,s=7;break;case 7:switch(g){case 34:case 39:h=new y,a=8,u=n+1,d=g;break;default:throw A.thrown(new S('Expected "',e,n))}break;case 8:switch(g){case 38:h.addSub(e,u,n-u),a=18,_=8,u=n+1;break;case 60:case 62:if(t)throw A.thrown(new S("Invalid unescaped "+String.fromCodePoint(g)+" in attribute value",e,n));g==d&&(h.addSub(e,u,n-u),f=h.toString(),h=new y,r.set(o,f),a=0,s=4);break;default:g==d&&(h.addSub(e,u,n-u),f=h.toString(),h=new y,r.set(o,f),a=0,s=4)}break;case 9:u=n=U.doParse(e,t,n,r),a=1;break;case 10:if(U.isValidChar(g))break;if(u==n)throw A.thrown(new S("Expected node name",e,n));var v=x.substr(e,u,n-u);if(null==i||0!=i.nodeType)throw A.thrown(new S("Unexpected </"+v+">, tag is not open",e,n));if(v!=i.get_nodeName())throw A.thrown(new S("Expected </"+i.get_nodeName()+">",e,n));a=0,s=12;continue;case 11:if(62!=g)throw A.thrown(new S("Expected >",e,n));a=1;break;case 12:if(62==g)return 0==l&&i.addChild(C.createPCData("")),n;throw A.thrown(new S("Expected >",e,n));case 13:60==g?(h.addSub(e,u,n-u),v=C.createPCData(h.toString()),h=new y,i.addChild(v),++l,a=0,s=2):38==g&&(h.addSub(e,u,n-u),a=18,_=13,u=n+1);break;case 14:63==g&&62==N.fastCodeAt(e,n+1)&&(p=x.substr(e,u+1,++n-u-2),i.addChild(C.createProcessingInstruction(p)),++l,a=1);break;case 15:45==g&&45==N.fastCodeAt(e,n+1)&&62==N.fastCodeAt(e,n+2)&&(i.addChild(C.createComment(x.substr(e,u,n-u))),++l,n+=2,a=1);break;case 16:91==g?++c:93==g?--c:62==g&&0==c&&(i.addChild(C.createDocType(x.substr(e,u,n-u))),++l,a=1);break;case 17:93==g&&93==N.fastCodeAt(e,n+1)&&62==N.fastCodeAt(e,n+2)&&(p=C.createCData(x.substr(e,u,n-u)),i.addChild(p),++l,n+=2,a=1);break;case 18:if(59==g){var m=x.substr(e,u,n-u);if(35==N.fastCodeAt(m,0)){var b=120==N.fastCodeAt(m,1)?w.parseInt("0"+x.substr(m,1,m.length-1)):w.parseInt(x.substr(m,1,m.length-1));h.addChar(b)}else if(U.escapes.exists(m))h.add(U.escapes.get(m));else{if(t)throw A.thrown(new S("Undefined entity: "+m,e,n));h.add("&"+m+";")}u=n+1,a=_}else if(!U.isValidChar(g)&&35!=g){if(t)throw A.thrown(new S("Invalid character in entity: "+String.fromCodePoint(g),e,n));h.addChar(38),h.addSub(e,u,n-u),u=--n+1,a=_}}++n}if(1==a&&(u=n,a=13),13==a){if(0==i.nodeType)throw A.thrown(new S("Unclosed node <"+i.get_nodeName()+">",e,n));n==u&&0!=l||(h.addSub(e,u,n-u),i.addChild(C.createPCData(h.toString())),++l)}else{if(t||18!=a||13!=_)throw A.thrown(new S("Unexpected end",e,n));h.addChar(38),h.addSub(e,u,n-u),i.addChild(C.createPCData(h.toString())),++l}return n},U.isValidChar=function(e){return 97<=e&&e<=122||65<=e&&e<=90||48<=e&&e<=57||58==e||46==e||95==e||45==e},function(e){this.output=new y,this.pretty=e}),m=(ne.__name__="haxe.xml.Printer",ne.print=function(e,t){t=new ne(t=null==t?!1:t);return t.writeNode(e,""),t.output.toString()},ne.prototype={writeNode:function(e,t){switch(e.nodeType){case 0:this.write(t+"<"),this.write(e.get_nodeName());for(var n=e.attributes();n.hasNext();){var i=n.next();this.write(" "+i+'="'),this.write(N.htmlEscape(e.get(i),!0)),this.write('"')}if(this.hasChildren(e)){this.write(">"),this.newline();for(var r=e.iterator();r.hasNext();){var a=r.next();this.writeNode(a,this.pretty?t+"\t":t)}this.write(t+"</"),this.write(e.get_nodeName()),this.write(">")}else this.write("/>");this.newline();break;case 1:var s=e.get_nodeValue();0!=s.length&&(this.write(t+N.htmlEscape(s)),this.newline());break;case 2:this.write(t+"<![CDATA["),this.write(e.get_nodeValue()),this.write("]]>"),this.newline();break;case 3:s=e.get_nodeValue();s="\x3c!--"+new F("[\n\r\t]+","g").replace(s,"")+"--\x3e",this.write(t),this.write(N.trim(s)),this.newline();break;case 4:this.write("<!DOCTYPE "+e.get_nodeValue()+">"),this.newline();break;case 5:this.write("<?"+e.get_nodeValue()+"?>"),this.newline();break;case 6:for(r=e.iterator();r.hasNext();){a=r.next();this.writeNode(a,t)}}},write:function(e){this.output.add(e)},newline:function(){this.pretty&&this.output.add("\n")},hasChildren:function(e){for(var t=e.iterator();t.hasNext();){var n=t.next();switch(n.nodeType){case 0:case 1:return!0;case 2:case 3:if(0!=N.ltrim(n.get_nodeValue()).length)return!0}}return!1},__class__:ne},function(){}),ie=(m.__name__="js.Boot",m.isClass=function(e){return e.__name__},m.isEnum=function(e){return e.__ename__},m.getClass=function(e){var t;return null==e?null:e instanceof Array?Array:null!=(t=e.__class__)?t:null!=(t=m.__nativeClassName(e))?m.__resolveNativeClass(t):null},m.__string_rec=function(r,a){if(null==r)return"null";if(5<=a.length)return"<...>";var s,e,t=typeof r;switch(t="function"==t&&(m.isClass(r)||m.isEnum(r))?"object":t){case"function":return"<function>";case"object":if(r.__enum__)return l=(s=q[r.__enum__].__constructs__[r._hx_index])._hx_name,s.__params__?(a+="\t",l+"("+function(){for(var e=[],t=0,n=s.__params__;t<n.length;){var i=n[t];t+=1,e.push(m.__string_rec(r[i],a))}return e}().join(",")+")"):l;if(r instanceof Array){for(var n="[",i=(a+="\t",0),o=r.length;i<o;){var u=i++;n+=(0<u?",":"")+m.__string_rec(r[u],a)}return n+="]"}try{e=r.toString}catch(i){return"???"}if(null!=e&&e!=Object.toString&&"function"==typeof e){var l=r.toString();if("[object Object]"!=l)return l}var n="{\n",c=(a+="\t",null!=r.hasOwnProperty),h=null;for(h in r)c&&!r.hasOwnProperty(h)||"prototype"!=h&&"__class__"!=h&&"__super__"!=h&&"__interfaces__"!=h&&"__properties__"!=h&&(2!=n.length&&(n+=", \n"),n+=a+h+" : "+m.__string_rec(r[h],a));return n+="\n"+(a=a.substring(1))+"}";case"string":return r;default:return String(r)}},m.__nativeClassName=function(e){e=m.__toStr.call(e).slice(8,-1);return"Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e},m.__resolveNativeClass=function(e){return L[e]},function(){}),P=(ie.__name__="js.Lib",ie.get_undefined=function(){},function(){});function re(e,t){var n;return null==t?null:(null==t.__id__&&(t.__id__=L.$haxeUID++),null==e.hx__closures__?e.hx__closures__={}:n=e.hx__closures__[t.__id__],null==n&&(n=t.bind(e),e.hx__closures__[t.__id__]=n),n)}P.__name__="kadabra.utils.XMLUtils",P.getFloat=function(e,t,n){return null==n&&(n=0),te.resolve(R.get_has(e),t)?w.parseFloat(V.resolve(R.get_att(e),t)):n},P.getInt=function(e,t,n){return null==n&&(n=0),te.resolve(R.get_has(e),t)?w.parseInt(V.resolve(R.get_att(e),t)):n},P.getBool=function(e,t,n){return null==n&&(n=!0),te.resolve(R.get_has(e),t)?"true"==V.resolve(R.get_att(e),t):n},P.getString=function(e,t,n){return null==n&&(n=""),te.resolve(R.get_has(e),t)?V.resolve(R.get_att(e),t):n},P.getFirstChild=function(e){for(var t=null,n=R.get_elements(e);n.hasNext();){t=n.next();break}return t},L.$haxeUID|=0,"undefined"!=typeof performance&&"function"==typeof performance.now&&(x.now=performance.now.bind(performance)),null==String.fromCodePoint&&(String.fromCodePoint=function(e){return e<65536?String.fromCharCode(e):String.fromCharCode(55232+(e>>10))+String.fromCharCode(56320+(1023&e))}),(String.prototype.__class__=String).__name__="String",Array.__name__="Array",m.__toStr={}.toString,C.Element=0,C.PCData=1,C.CData=2,C.Comment=3,C.DocType=4,C.ProcessingInstruction=5,C.Document=6,p.CONTINUE="Continue",p.QUIT="Quit",M.EXIT="$$EXIT$$",h.helperList=new c,h.regexp=new F("([a-zA-Z0-9_-]+)(=|!=|>=|<=|<|>|\\(in:)?([a-zA-Z0-9_-]*)","g"),_.GREATER=">",_.LOWER="<",_.GREATER_EQUAL=">=",_.LOWER_EQUAL="<=",_.EQUAL="=",_.DIFFERENT="!=",_.IN="in",U.escapes=((u=new c).set("lt","<"),u.set("gt",">"),u.set("amp","&"),u.set("quot",'"'),u.set("apos","'"),u)}("undefined"!=typeof exports?exports:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this,"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);